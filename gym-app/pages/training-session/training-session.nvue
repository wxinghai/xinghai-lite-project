<template>
	<view class="container">
		<!-- åŠ è½½ä¸­ -->
		<view v-if="loading" class="loading-container">
			<text class="loading-text">åŠ è½½è®­ç»ƒæ•°æ®ä¸­...</text>
		</view>
		
		<!-- é”™è¯¯æç¤º -->
		<view v-else-if="error" class="error-container">
			<text class="error-text">{{ error }}</text>
			<view class="error-button" @click="goBack">
				<text class="error-button-text">è¿”å›</text>
			</view>
		</view>
		
		<!-- è®­ç»ƒä¼šè¯å†…å®¹ -->
		<block v-else-if="trainingData">
			<!-- é¡µé¢å¤´éƒ¨ -->
			<view class="header">
				<view class="header-left">
					<view class="timer-container">
						<text class="timer">{{ formattedSessionTime }}</text>
						<!-- è®¡æ—¶å™¨æ§åˆ¶æŒ‰é’® -->
						<view v-if="!timer.isRunning" class="timer-control-button start" @click="startTimer">
							<text class="timer-button-text">å¼€å§‹è®¡æ—¶</text>
						</view>
						<view v-else class="timer-control-button pause" @click="pauseTimer">
							<text class="timer-button-text">æš‚åœ</text>
						</view>
					</view>
					<view class="training-name">
						<text class="training-title">{{ trainingData.title }}</text>
						<text class="training-name-edit" @click="editTrainingName">âœï¸</text>
					</view>
				</view>
				
				<view class="header-right">
					<view class="action-button" @click="completeTraining">
						<text class="action-button-text">å®Œæˆ</text>
					</view>
					<rest-timer 
					 :duration="90"
      :stepSeconds="15"
      @finish="onRestFinish"
      @tick="onTick"></rest-timer>
					<view class="stats">
						<view class="stats-text"><text class="stats-highlight">{{ completedSets }}/{{ totalSets }} ç»„</text></view>
						<view class="stats-text"><text class="stats-highlight">{{ totalVolume }}kg å®¹é‡</text></view>
					</view>
				</view>
			</view>
			<!-- è¿åŠ¨åˆ—è¡¨ -->
			<list class="exercise-list" showScrollbar="true">
				<cell v-for="(exercise, exerciseIndex) in trainingData.exercises" :key="exercise.id">
					<view 
						class="exercise-card" 
						:class="{ 'collapsed': exercise.collapsed }"
						:ref="`exercise-${exerciseIndex}`"
					>
						<!-- è¿åŠ¨æ ‡é¢˜æ  -->
						<view class="exercise-header" @click="toggleExerciseCollapse(exerciseIndex)">
							<view class="exercise-name-wrapper">
								<text class="exercise-name">{{ exercise.name }}</text>
								<!-- æŠ˜å çŠ¶æ€ä¸‹æ˜¾ç¤ºè¿›åº¦ -->
								<view class="exercise-progress" v-if="exercise.collapsed">
									<text class="exercise-sets-count">{{ exercise.sets.length }}ç»„</text>
									<view class="exercise-dots">
										<view 
											v-for="(set, dotIndex) in exercise.sets" 
											:key="'dot-'+dotIndex" 
											class="dot"
											:class="{ 'completed': set.completed }"
										></view>
									</view>
								</view>
							</view>
							
							<view class="exercise-actions">
								<view class="icon-button" @click.stop="showExerciseNotes(exerciseIndex)">
									<text class="icon">ğŸ“</text>
								</view>
								<view class="icon-button" @click.stop="showExerciseMenu(exerciseIndex)">
									<text class="icon">â‹¯</text>
								</view>
							</view>
						</view>
						
					
						
						<!-- è¿åŠ¨è¯¦æƒ…å†…å®¹ -->
						<view class="collapsible-content">
							<!-- ç»„æ•°åˆ—è¡¨ -->
							<view class="set-list">
								<view class="set-list-header">
									<text class="set-list-title">ç»„æ•°ä¿¡æ¯</text>
									<view class="unit-toggle">
										<view 
											class="unit-toggle-btn" 
											:class="{ 'active': exercise.weightUnit === 'kg' }"
											@click="changeWeightUnit(exerciseIndex, 'kg')"
										>
											<text class="unit-text" :class="{ 'active-text': exercise.weightUnit === 'kg' }">KG</text>
										</view>
										<view 
											class="unit-toggle-btn"
											:class="{ 'active': exercise.weightUnit === 'lbs' }"
											@click="changeWeightUnit(exerciseIndex, 'lbs')"
										>
											<text class="unit-text" :class="{ 'active-text': exercise.weightUnit === 'lbs' }">LBS</text>
										</view>
									</view>
								</view>
								
								<!-- ç»„æ•°è¡¨å¤´ -->
								<view class="set-row set-header">
									<text class="set-header-text set-number-col">ç»„æ•°</text>
									<text class="set-header-text set-weight-col">
										é‡é‡({{ exercise.weightUnit }})
									</text>
									<text class="set-header-text set-reps-col">æ¬¡æ•°</text>
									<text class="set-header-text set-complete-col">å®Œæˆ</text>
									<text class="set-header-text set-actions-col"></text>
								</view>
								
								<!-- ç»„æ•°åˆ—è¡¨ -->
								<view 
									class="set-row" 
									v-for="(set, setIndex) in exercise.sets"
									:key="'set-'+exerciseIndex+'-'+setIndex"
								>
									<text class="set-number-col">{{ setIndex + 1 }}</text>
									<view class="set-weight-col">
										<input 
											class="set-input" 
											type="number" 
											v-model="set.weight" 
											@change="calculateVolume"
										/>
									</view>
									<view class="set-reps-col">
										<input 
											class="set-input" 
											type="number" 
											v-model="set.reps" 
											@change="calculateVolume"
										/>
									</view>
									<view class="set-complete-col" @click="toggleSetComplete(exerciseIndex, setIndex)">
										<view class="custom-checkbox">
											<view class="checkbox-inner" v-if="set.completed">
												<text class="checkbox-icon">âœ“</text>
											</view>
										</view>
									</view>
									<view class="set-actions-col">
										<view class="set-actions-btn" @click="showSetMenu(exerciseIndex, setIndex)">
											<text class="icon">â‹¯</text>
										</view>
									</view>
								</view>
								
								<!-- æ·»åŠ ç»„æ•°æŒ‰é’® -->
								<view class="add-set" @click="addSet(exerciseIndex)">
									<text class="add-set-text">+ æ·»åŠ ç»„æ•°</text>
								</view>
							</view>
							
							<!-- å¤‡æ³¨ä¿¡æ¯ -->
							<view class="exercise-notes" v-if="exercise.notes">
								<text class="notes-text">{{ exercise.notes }}</text>
							</view>
						</view>
					</view>
				</cell>
				
				<!-- æ·»åŠ åŠ¨ä½œæŒ‰é’® -->
				<cell>
					<view class="add-exercise" @click="showAddExerciseModal">
						<text class="add-exercise-text">+ æ·»åŠ åŠ¨ä½œ</text>
					</view>
				</cell>
			</list>
			
			<!-- åº•éƒ¨å¯¼èˆª -->
			<view class="bottom-nav">
				<view class="bottom-nav-btn" @click="minimizeSession">
					<text class="bottom-icon">â¬‡ï¸</text>
					<text class="bottom-text">æœ€å°åŒ–</text>
				</view>
				<view class="bottom-nav-btn" @click="testRestTimer">
					<text class="bottom-icon">â±ï¸</text>
					<text class="bottom-text">ä¼‘æ¯è®¡æ—¶</text>
				</view>
				<view class="bottom-nav-btn" @click="showAddExerciseModal">
					<text class="bottom-icon">â•</text>
					<text class="bottom-text">æ·»åŠ åŠ¨ä½œ</text>
				</view>
				<view class="bottom-nav-btn delete" @click="showDeleteConfirm">
					<text class="bottom-icon">ğŸ—‘ï¸</text>
					<text class="bottom-text">åˆ é™¤è®­ç»ƒ</text>
				</view>
				<view class="bottom-nav-btn save" @click="saveAndExit">
					<text class="bottom-icon">ğŸ’¾</text>
					<text class="bottom-text">ä¿å­˜è¿”å›</text>
				</view>
			</view>
		</block>
	</view>
</template>

<script>
	import TrainingService from '../../utils/services/TrainingService.js';
	import RestTimer from '../../components/training/RestTimer.nvue';
	
	export default {
		components: {
			RestTimer
		},
		data() {
			return {
				// è®­ç»ƒä¼šè¯æ•°æ®
				trainingData: null,
				// è®¡æ—¶å™¨
				timer: {
					startTime: 0,
					currentTime: 0,
					isRunning: false,
					timerId: null
				},
				// æ€»é‡é‡
				totalVolume: 0,
				// æ˜¯å¦æ˜¾ç¤ºç»„æ•°èœå•
				activeSetMenu: {
					exerciseIndex: -1,
					setIndex: -1
				},
				// é¡µé¢çŠ¶æ€
				loading: true,
				error: null,
				
				// ä¼‘æ¯è®¡æ—¶å™¨ç›¸å…³
				restTimerVisible: false,
				 
				nextExerciseInfo: '',
				
				// ä¿å­˜å½“å‰æ“ä½œçš„ç»ƒä¹ å’Œç»„ç´¢å¼•
				activeExerciseIndex: -1,
				activeSetIndex: -1,
				lastCompletedExerciseIndex: -1,
				lastCompletedSetIndex: -1
			}
		},
		
		computed: {
			// è®¡ç®—å·²å®Œæˆç»„æ•°
			completedSets() {
				if (!this.trainingData) return 0;
				
				let count = 0;
				this.trainingData.exercises.forEach(exercise => {
					exercise.sets.forEach(set => {
						if (set.completed) count++;
					});
				});
				return count;
			},
			
			// è®¡ç®—æ€»ç»„æ•°
			totalSets() {
				if (!this.trainingData) return 0;
				
				let count = 0;
				this.trainingData.exercises.forEach(exercise => {
					count += exercise.sets.length;
				});
				return count;
			},
			
			// æ ¼å¼åŒ–ä¼šè¯æ—¶é—´
			formattedSessionTime() {
				const elapsed = Math.floor((this.timer.currentTime - this.timer.startTime) / 1000);
				const hours = Math.floor(elapsed / 3600);
				const minutes = Math.floor((elapsed % 3600) / 60);
				const seconds = elapsed % 60;
				
				return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
			}
		},
		
		onLoad(options) {
			// å¦‚æœæœ‰ä¼ å…¥è®­ç»ƒIDï¼Œåˆ™åŠ è½½è¯¥è®­ç»ƒ
			if (options.id) {
				this.loadTraining(options.id);
			} else {
				// æ£€æŸ¥æ˜¯å¦æœ‰è¿›è¡Œä¸­çš„è®­ç»ƒ
				const activeTraining = TrainingService.getActiveTraining();
				if (activeTraining) {
					this.trainingData = activeTraining;
					this.loading = false;
					
					// æ¢å¤è®¡æ—¶å™¨
					this.timer.startTime = activeTraining.startTime;
					this.timer.currentTime = Date.now();
					
					// å¦‚æœä¼šè¯ä¸­è®°å½•äº†è®¡æ—¶å™¨çŠ¶æ€ï¼Œåˆ™æ¢å¤
					if (activeTraining.timerRunning) {
						this.startTimer();
					}
				} else {
					// å¦‚æœæ²¡æœ‰æ´»åŠ¨çš„è®­ç»ƒä¼šè¯ï¼Œåˆ™ä½¿ç”¨é»˜è®¤è®­ç»ƒå†…å®¹
					const defaultTraining = TrainingService.getDefaultTraining();
					this.trainingData = TrainingService.startTraining(defaultTraining);
					this.timer.startTime = this.trainingData.startTime;
					this.timer.currentTime = this.trainingData.startTime;
					this.loading = false;
				}
			}
		},
		
		onReady() {
			// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
		},
		
		onUnload() {
			// åœæ­¢è®¡æ—¶å™¨
			this.stopTimer();
			
			// ä¿å­˜å½“å‰è®­ç»ƒçŠ¶æ€
			if (this.trainingData) {
				TrainingService.updateActiveTraining(this.trainingData);
			}
		},
		
		methods: {
  onRestFinish(elapsed) {
      // elapsed ä¸ºæœ¬æ¬¡ä¼‘æ¯çš„å®é™…æ—¶é•¿ï¼ˆç§’ï¼‰
      uni.showToast({ title: `ä¼‘æ¯ç”¨æ—¶ ${elapsed}s`, icon: 'none' })
      // ä¸‹ä¸€æ¬¡ä¼‘æ¯ï¼šå¯æ›´æ–°çˆ¶çº§çš„ duration è§¦å‘ä¸‹ä¸€è½®ï¼Œæˆ–ä½¿ç”¨ :key å¼ºåˆ¶é‡å»ºç»„ä»¶
    },
	onRestFinish() {},
    onTick(remaining) {
      // æ¯ç§’å›è°ƒï¼ˆå¯é€‰ï¼‰
    },

			// åŠ è½½è®­ç»ƒæ•°æ®
			loadTraining(id) {
				try {
					this.loading = true;
					
					// è·å–æ´»åŠ¨è®­ç»ƒä¼šè¯
					const activeTraining = TrainingService.getActiveTraining();
					
					// å¦‚æœæ˜¯å½“å‰ä¼šè¯ï¼Œç›´æ¥ä½¿ç”¨
					if (activeTraining && activeTraining.id === id) {
						this.trainingData = activeTraining;
						
						// è®¾ç½®è®¡æ—¶å™¨åˆå§‹æ—¶é—´ï¼Œä½†ä¸è‡ªåŠ¨å¯åŠ¨
						this.timer.startTime = activeTraining.startTime || Date.now();
						this.timer.currentTime = Date.now();
						
						// å¦‚æœä¼šè¯ä¸­è®°å½•äº†è®¡æ—¶å™¨çŠ¶æ€ï¼Œåˆ™æ¢å¤
						if (activeTraining.timerRunning) {
							this.startTimer();
						}
					} else if (id && id.startsWith('session_')) {
						// æŸ¥æ‰¾è®­ç»ƒè®¡åˆ’
						const trainingPlanId = id.replace('session_', 'plan_');
						const trainingPlan = TrainingService.getTrainingPlanById(trainingPlanId);
						
						if (trainingPlan) {
							// å¼€å§‹æ–°è®­ç»ƒ
							this.trainingData = TrainingService.startTraining(trainingPlan);
							this.timer.startTime = this.trainingData.startTime;
							this.timer.currentTime = this.trainingData.startTime;
							
							// ä¸è‡ªåŠ¨å¯åŠ¨è®¡æ—¶å™¨
						} else {
							// ä½¿ç”¨é»˜è®¤è®­ç»ƒ
							const defaultTraining = TrainingService.getDefaultTraining();
							this.trainingData = TrainingService.startTraining(defaultTraining);
							this.timer.startTime = this.trainingData.startTime;
							this.timer.currentTime = this.trainingData.startTime;
						}
					} else {
						// ä½¿ç”¨é»˜è®¤è®­ç»ƒ
						const defaultTraining = TrainingService.getDefaultTraining();
						this.trainingData = TrainingService.startTraining(defaultTraining);
						this.timer.startTime = this.trainingData.startTime;
						this.timer.currentTime = this.trainingData.startTime;
					}
					
					// åˆå§‹è®¡ç®—æ€»é‡é‡
					this.$nextTick(() => {
						this.calculateVolume();
					});
				} catch (err) {
					console.error('åŠ è½½è®­ç»ƒä¼šè¯å‡ºé”™:', err);
					this.error = 'åŠ è½½è®­ç»ƒä¼šè¯å¤±è´¥';
				} finally {
					this.loading = false;
				}
			},
			
			// å¯åŠ¨è®¡æ—¶å™¨
			startTimer() {
				if (this.timer.timerId) return;
				
				// å¦‚æœæ˜¯é¦–æ¬¡å¯åŠ¨è®¡æ—¶å™¨ï¼Œé‡ç½®å¼€å§‹æ—¶é—´
				if (this.timer.currentTime === this.timer.startTime) {
					this.timer.startTime = Date.now();
					this.timer.currentTime = Date.now();
					
					// æ›´æ–°åˆ°è®­ç»ƒæ•°æ®ä¸­
					if (this.trainingData) {
						this.trainingData.startTime = this.timer.startTime;
					}
				}
				
				this.timer.isRunning = true;
				this.timer.timerId = setInterval(() => {
					this.timer.currentTime = Date.now();
				}, 1000);
				
				// æ›´æ–°è®­ç»ƒä¼šè¯ä¸­çš„è®¡æ—¶å™¨çŠ¶æ€
				if (this.trainingData) {
					this.trainingData.timerRunning = true;
					TrainingService.updateActiveTraining(this.trainingData);
				}
			},
			
			// æš‚åœè®¡æ—¶å™¨
			pauseTimer() {
				if (this.timer.timerId) {
					clearInterval(this.timer.timerId);
					this.timer.timerId = null;
					this.timer.isRunning = false;
					
					// æ›´æ–°è®­ç»ƒä¼šè¯ä¸­çš„è®¡æ—¶å™¨çŠ¶æ€
					if (this.trainingData) {
						this.trainingData.timerRunning = false;
						TrainingService.updateActiveTraining(this.trainingData);
					}
				}
			},
			
			// åœæ­¢è®¡æ—¶å™¨
			stopTimer() {
				if (this.timer.timerId) {
					clearInterval(this.timer.timerId);
					this.timer.timerId = null;
					this.timer.isRunning = false;
				}
			},
			
			// è®¡ç®—æ€»é‡é‡
			calculateVolume() {
				let volume = 0;
				
				if (this.trainingData && this.trainingData.exercises) {
					this.trainingData.exercises.forEach(exercise => {
						exercise.sets.forEach(set => {
							// åªè®¡ç®—å·²å®Œæˆçš„ç»„
							if (set.completed) {
								let weight = parseFloat(set.weight) || 0;
								let reps = parseInt(set.reps) || 0;
								
								// å¦‚æœæ˜¯ç£…ï¼Œè½¬æ¢ä¸ºå…¬æ–¤
								if (exercise.weightUnit === 'lbs') {
									weight = weight * 0.453592;
								}
								
								volume += weight * reps;
							}
						});
					});
				}
				
				// å–æ•´
				this.totalVolume = Math.round(volume);
			},
			
			// åˆ‡æ¢è¿åŠ¨æŠ˜å çŠ¶æ€
			toggleExerciseCollapse(index) {
				this.trainingData.exercises[index].collapsed = !this.trainingData.exercises[index].collapsed;
				
				// è§¦å‘å¸ƒå±€æ›´æ–°
				this.$nextTick(() => {
					// å¼ºåˆ¶é‡æ–°è®¡ç®—å¸ƒå±€
					setTimeout(() => {
						// åœ¨iOSå’ŒAndroidä¸Šå¯èƒ½éœ€è¦ä¸åŒçš„æ–¹å¼æ¥è§¦å‘é‡ç»˜
						if (uni.getSystemInfoSync().platform === 'ios') {
							// iOSä¸Šçš„å¸ƒå±€åˆ·æ–°æ–¹æ³•
							const currentPage = getCurrentPages()[getCurrentPages().length - 1];
							if (currentPage && currentPage.$vm && currentPage.$vm.$forceUpdate) {
								currentPage.$vm.$forceUpdate();
							}
						} else {
							// Androidä¸Šå¯èƒ½éœ€è¦è§¦å‘æ»šåŠ¨æ¥åˆ·æ–°åˆ—è¡¨
							const dom = uni.requireNativePlugin('dom');
							if (dom && dom.scrollToElement) {
								try {
									// å°è¯•æ»šåŠ¨åˆ°å½“å‰å…ƒç´ 
									const el = this.$refs[`exercise-${index}`];
									if (el) {
										dom.scrollToElement(el, { offset: 0 });
									}
								} catch (e) {
									console.log('æ»šåŠ¨åˆ·æ–°å¤±è´¥', e);
								}
							}
						}
					}, 50);
				});
			},
			
			// åˆ‡æ¢é‡é‡å•ä½
			changeWeightUnit(exerciseIndex, unit) {
				const exercise = this.trainingData.exercises[exerciseIndex];
				
				// å¦‚æœå·²ç»æ˜¯åŒä¸€å•ä½ï¼Œä¸åšæ”¹å˜
				if (exercise.weightUnit === unit) return;
				
				// è½¬æ¢æ¯ç»„çš„é‡é‡
				exercise.sets.forEach(set => {
					let weight = parseFloat(set.weight) || 0;
					
					if (unit === 'kg' && exercise.weightUnit === 'lbs') {
						// ç£…è½¬å…¬æ–¤
						set.weight = Math.round(weight * 0.453592);
					} else if (unit === 'lbs' && exercise.weightUnit === 'kg') {
						// å…¬æ–¤è½¬ç£…
						set.weight = Math.round(weight * 2.20462);
					}
				});
				
				// æ›´æ–°å•ä½
				exercise.weightUnit = unit;
				
				// é‡æ–°è®¡ç®—æ€»é‡é‡
				this.calculateVolume();
			},
			
			// åˆ‡æ¢ç»„å®ŒæˆçŠ¶æ€
			toggleSetComplete(exerciseIndex, setIndex) {
				if (!this.trainingData) return;
				
				const exercise = this.trainingData.exercises[exerciseIndex];
				const set = exercise.sets[setIndex];
				set.completed = !set.completed;
				
				// è®°å½•æœ€åæ“ä½œçš„ç»„
				this.activeExerciseIndex = exerciseIndex;
				this.activeSetIndex = setIndex;
				
				// å¦‚æœæ ‡è®°ä¸ºå·²å®Œæˆ
				if (set.completed) {
					// è®°å½•è¿™æ˜¯åˆšå®Œæˆçš„ç»„
					this.lastCompletedExerciseIndex = exerciseIndex;
					this.lastCompletedSetIndex = setIndex;
					
					// å¯åŠ¨ä¼‘æ¯å€’è®¡æ—¶
					setTimeout(() => {
						// åªæœ‰åœ¨å½“å‰ç»„å®Œæˆæ—¶æ‰è‡ªåŠ¨å¼€å§‹ä¼‘æ¯
						if (this.lastCompletedExerciseIndex === exerciseIndex && 
							this.lastCompletedSetIndex === setIndex) {
							// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ç»„éœ€è¦è®­ç»ƒ
							const hasNextSet = this.hasNextSet(exerciseIndex, setIndex);
							if (hasNextSet) {
								// å¯åŠ¨ä¼‘æ¯è®¡æ—¶å™¨
							 
							}
						}
					}, 500);

					// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå®Œæˆçš„ç»„ï¼Œä¸”è®¡æ—¶å™¨æœªå¼€å§‹ï¼Œåˆ™è‡ªåŠ¨å¼€å§‹è®¡æ—¶å™¨
					if (this.completedSets === 1 && !this.timer.isRunning) {
						this.startTimer();
						uni.showToast({
							title: 'è®¡æ—¶å·²å¼€å§‹',
							icon: 'none',
							position: 'bottom'
						});
					}
				}
				
				// æ›´æ–°è®­ç»ƒæ•°æ®
				TrainingService.updateActiveTraining(this.trainingData);
			},
			
 
			// æ›´æ–°ä¸‹ä¸€ç»„è®­ç»ƒä¿¡æ¯
			updateNextExerciseInfo() {
				// è·å–ä¸‹ä¸€ç»„è®­ç»ƒä¿¡æ¯
				const exercises = this.trainingData.exercises;
				let nextExerciseIndex = this.activeExerciseIndex;
				let nextSetIndex = this.activeSetIndex + 1;
				
				// æ£€æŸ¥å½“å‰åŠ¨ä½œæ˜¯å¦æœ‰æ›´å¤šç»„
				if (nextSetIndex >= exercises[nextExerciseIndex].sets.length) {
					nextExerciseIndex++;
					nextSetIndex = 0;
				}
				
				// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªåŠ¨ä½œ
				if (nextExerciseIndex < exercises.length) {
					const nextExercise = exercises[nextExerciseIndex];
					const setNumber = nextSetIndex + 1;
					this.nextExerciseInfo = `${nextExercise.name} - ç¬¬${setNumber}ç»„`;
				} else {
					this.nextExerciseInfo = 'è®­ç»ƒå³å°†ç»“æŸ';
				}
			},
			
			// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ç»„éœ€è¦è®­ç»ƒ
			hasNextSet(currentExerciseIndex, currentSetIndex) {
				const exercises = this.trainingData.exercises;
				
				// æ£€æŸ¥å½“å‰åŠ¨ä½œæ˜¯å¦æœ‰æ›´å¤šç»„
				if (currentSetIndex < exercises[currentExerciseIndex].sets.length - 1) {
					return true;
				}
				
				// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªåŠ¨ä½œ
				if (currentExerciseIndex < exercises.length - 1) {
					return true;
				}
				
				// æ²¡æœ‰ä¸‹ä¸€ç»„
				return false;
			},
			
			// æ·»åŠ æ–°çš„ç»„
			addSet(exerciseIndex) {
				const exercise = this.trainingData.exercises[exerciseIndex];
				const lastSet = exercise.sets[exercise.sets.length - 1];
				
				// å¤åˆ¶ä¸Šä¸€ç»„çš„æ•°æ®ä½œä¸ºé»˜è®¤å€¼
				const newSet = {
					weight: lastSet ? lastSet.weight : 0,
					reps: lastSet ? lastSet.reps : 0,
					completed: false
				};
				
				exercise.sets.push(newSet);
			},
			
			// æ˜¾ç¤ºç»„æ“ä½œèœå•
			showSetMenu(exerciseIndex, setIndex) {
				// ä¿å­˜å½“å‰æ“ä½œçš„ç»„ç´¢å¼•
				this.activeExerciseIndex = exerciseIndex;
				this.activeSetIndex = setIndex;
				
				// å®é™…ä¸­å¯èƒ½éœ€è¦æ˜¾ç¤ºå¼¹çª—æˆ–æ“ä½œèœå•
				uni.showActionSheet({
					itemList: ['ç›´æ¥è¿›å…¥ä¸‹ä¸€ç»„', 'å¯åŠ¨ä¼‘æ¯è®¡æ—¶', 'è®¾ç½®ä¸‹ä¸€ç»„å‚æ•°', 'å¤åˆ¶æœ¬ç»„', 'åˆ é™¤'],
					success: (res) => {
						const index = res.tapIndex;
						
						switch (index) {
							case 0: // ç›´æ¥è¿›å…¥ä¸‹ä¸€ç»„
								// å°è¯•è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ç»„
								this.focusNextSet();
								break;
							case 1: // å¯åŠ¨ä¼‘æ¯è®¡æ—¶
								 
								break;
							case 2: // è®¾ç½®ä¸‹ä¸€ç»„å‚æ•°
								this.showNextSetParamsDialog();
								break;
							case 3: // å¤åˆ¶æœ¬ç»„
								this.duplicateSet(exerciseIndex, setIndex);
								break;
							case 4: // åˆ é™¤
								this.deleteSet(exerciseIndex, setIndex);
								break;
						}
					}
				});
			},
			
			// æ˜¾ç¤ºè®¾ç½®ä¸‹ä¸€ç»„å‚æ•°çš„å¯¹è¯æ¡†
			showNextSetParamsDialog() {
				// è·å–ä¸‹ä¸€ç»„ä¿¡æ¯
				const exercises = this.trainingData.exercises;
				let nextExerciseIndex = this.activeExerciseIndex;
				let nextSetIndex = this.activeSetIndex + 1;
				
				// æ£€æŸ¥å½“å‰åŠ¨ä½œæ˜¯å¦æœ‰æ›´å¤šç»„
				if (nextSetIndex >= exercises[nextExerciseIndex].sets.length) {
					nextExerciseIndex++;
					nextSetIndex = 0;
					
					// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªåŠ¨ä½œ
					if (nextExerciseIndex >= exercises.length) {
						uni.showToast({
							title: 'å·²ç»æ˜¯æœ€åä¸€ç»„',
							icon: 'none'
						});
						return;
					}
				}
				
				const nextExercise = exercises[nextExerciseIndex];
				const nextSet = nextExercise.sets[nextSetIndex];
				
				// æ˜¾ç¤ºç¼–è¾‘å¯¹è¯æ¡†
				uni.showModal({
					title: `è®¾ç½®ä¸‹ä¸€ç»„å‚æ•° - ${nextExercise.name}`,
					content: `ç¬¬${nextSetIndex + 1}ç»„: é‡é‡(${nextExercise.weightUnit})=${nextSet.weight || 0}, æ¬¡æ•°=${nextSet.reps || 0}`,
					confirmText: 'å¼€å§‹ä¸‹ä¸€ç»„',
					cancelText: 'å–æ¶ˆ',
					success: (res) => {
						if (res.confirm) {
							// å°è¯•è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ç»„
							this.focusNextSet();
						}
					}
				});
			},
			
			// æ˜¾ç¤ºè‡ªå®šä¹‰ä¼‘æ¯æ—¶é—´å¯¹è¯æ¡†
			showCustomRestTimeDialog() {
				uni.showModal({
					title: 'è®¾ç½®ä¼‘æ¯æ—¶é—´',
					content: 'è¾“å…¥ä¼‘æ¯æ—¶é—´ï¼ˆç§’ï¼‰',
					editable: true,
					placeholderText: '60',
					success: (res) => {
						if (res.confirm) {
							const seconds = parseInt(res.content);
							if (!isNaN(seconds) && seconds > 0) {
							 
							} else {
								uni.showToast({
									title: 'è¯·è¾“å…¥æœ‰æ•ˆçš„ç§’æ•°',
									icon: 'none'
								});
							}
						}
					}
				});
			},
			
			// å¤åˆ¶ç»„
			duplicateSet(exerciseIndex, setIndex) {
				const exercise = this.trainingData.exercises[exerciseIndex];
				const setToCopy = exercise.sets[setIndex];
				
				// åˆ›å»ºå‰¯æœ¬
				const newSet = {
					weight: setToCopy.weight,
					reps: setToCopy.reps,
					completed: false
				};
				
				// æ’å…¥åˆ°å½“å‰ç»„åé¢
				exercise.sets.splice(setIndex + 1, 0, newSet);
			},
			
			// åˆ é™¤ç»„
			deleteSet(exerciseIndex, setIndex) {
				const exercise = this.trainingData.exercises[exerciseIndex];
				
				// ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªç»„
				if (exercise.sets.length > 1) {
					exercise.sets.splice(setIndex, 1);
					
					// æ›´æ–°æ€»é‡é‡
					this.calculateVolume();
				} else {
					uni.showToast({
						title: 'è‡³å°‘ä¿ç•™ä¸€ä¸ªç»„',
						icon: 'none'
					});
				}
			},
			
			// æ˜¾ç¤ºåŠ¨ä½œå¤‡æ³¨
			showExerciseNotes(exerciseIndex) {
				const exercise = this.trainingData.exercises[exerciseIndex];
				
				// æ˜¾ç¤º/ç¼–è¾‘å¤‡æ³¨çš„å¼¹çª—
				uni.showModal({
					title: 'åŠ¨ä½œå¤‡æ³¨',
					editable: true,
					placeholderText: 'è¾“å…¥å¤‡æ³¨ä¿¡æ¯',
					content: exercise.notes || '',
					success: (res) => {
						if (res.confirm) {
							exercise.notes = res.content;
						}
					}
				});
			},
			
			// æ˜¾ç¤ºåŠ¨ä½œèœå•
			showExerciseMenu(exerciseIndex) {
				uni.showActionSheet({
					itemList: ['è°ƒæ•´é¡ºåº', 'åˆ é™¤åŠ¨ä½œ'],
					success: (res) => {
						const index = res.tapIndex;
						
						switch (index) {
							case 0: // è°ƒæ•´é¡ºåº
								this.showReorderModal();
								break;
							case 1: // åˆ é™¤åŠ¨ä½œ
								this.deleteExercise(exerciseIndex);
								break;
						}
					}
				});
			},
			
			// åˆ é™¤åŠ¨ä½œ
			deleteExercise(exerciseIndex) {
				uni.showModal({
					title: 'ç¡®è®¤åˆ é™¤',
					content: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåŠ¨ä½œå—ï¼Ÿ',
					success: (res) => {
						if (res.confirm) {
							this.trainingData.exercises.splice(exerciseIndex, 1);
							
							// æ›´æ–°æ€»é‡é‡
							this.calculateVolume();
						}
					}
				});
			},
			
			// ç¼–è¾‘è®­ç»ƒåç§°
			editTrainingName() {
				uni.showModal({
					title: 'ç¼–è¾‘è®­ç»ƒåç§°',
					editable: true,
					content: this.trainingData.title,
					success: (res) => {
						if (res.confirm && res.content) {
							this.trainingData.title = res.content;
						}
					}
				});
			},
			
			// æ˜¾ç¤ºæ·»åŠ åŠ¨ä½œæ¨¡æ€æ¡†
			showAddExerciseModal() {
				// å®é™…é¡¹ç›®ä¸­å¯èƒ½éœ€è¦å¯¼èˆªåˆ°é€‰æ‹©åŠ¨ä½œé¡µé¢
				uni.showToast({
					title: 'æ­¤åŠŸèƒ½å°†æ‰“å¼€åŠ¨ä½œé€‰æ‹©é¡µé¢',
					icon: 'none'
				});
			},
			
			// æ˜¾ç¤ºæ’åºæ¨¡æ€æ¡†
			showReorderModal() {
				uni.showToast({
					title: 'æ’åºåŠŸèƒ½å¾…å®ç°',
					icon: 'none'
				});
			},
			
			// æœ€å°åŒ–ä¼šè¯
			minimizeSession() {
				// å¾…å®ç°æœ€å°åŒ–åŠŸèƒ½
				uni.showToast({
					title: 'æœ€å°åŒ–åŠŸèƒ½å¾…å®ç°',
					icon: 'none'
				});
			},
			
			// å®Œæˆè®­ç»ƒ
			completeTraining() {
				// ä¿å­˜è®­ç»ƒè®°å½•
				TrainingService.completeTraining(this.trainingData);
				
				uni.showToast({
					title: 'è®­ç»ƒå·²å®Œæˆ',
					icon: 'success',
					duration: 2000,
					success: () => {
						// è¿”å›ä¸Šä¸€é¡µ
						setTimeout(() => {
							uni.navigateBack();
						}, 2000);
					}
				});
			},
			
			// ä¿å­˜å¹¶é€€å‡º
			saveAndExit() {
				// ä¿å­˜è®­ç»ƒçŠ¶æ€
				TrainingService.updateActiveTraining(this.trainingData);
				
				uni.showToast({
					title: 'è®­ç»ƒå·²ä¿å­˜',
					icon: 'success',
					duration: 1500,
					success: () => {
						// è¿”å›ä¸Šä¸€é¡µ
						setTimeout(() => {
							uni.navigateBack();
						}, 1500);
					}
				});
			},
			
			// æ˜¾ç¤ºåˆ é™¤ç¡®è®¤
			showDeleteConfirm() {
				uni.showModal({
					title: 'ç¡®è®¤åˆ é™¤',
					content: 'ç¡®å®šè¦åˆ é™¤è¿™æ¬¡è®­ç»ƒè®°å½•å—ï¼Ÿæ‰€æœ‰æ•°æ®å°†ä¸¢å¤±ã€‚',
					success: (res) => {
						if (res.confirm) {
							// å–æ¶ˆå½“å‰è®­ç»ƒ
							TrainingService.cancelActiveTraining();
							
							uni.showToast({
								title: 'å·²åˆ é™¤è®­ç»ƒ',
								icon: 'success',
								duration: 1500,
								success: () => {
									// è¿”å›ä¸Šä¸€é¡µ
									setTimeout(() => {
										uni.navigateBack();
									}, 1500);
								}
							});
						}
					}
				});
			},

			// è¿”å›ä¸Šä¸€é¡µ
			goBack() {
				uni.navigateBack();
			},

			// åˆ‡æ¢åˆ°ä¸‹ä¸€ç»„
			focusNextSet() {
				if (this.activeExerciseIndex < 0 || this.activeSetIndex < 0) return;
				
				const exercises = this.trainingData.exercises;
				let nextExerciseIndex = this.activeExerciseIndex;
				let nextSetIndex = this.activeSetIndex + 1;
				
				// æ£€æŸ¥å½“å‰åŠ¨ä½œæ˜¯å¦æœ‰æ›´å¤šç»„
				if (nextSetIndex >= exercises[nextExerciseIndex].sets.length) {
					nextExerciseIndex++;
					nextSetIndex = 0;
				}
				
				// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªåŠ¨ä½œ
				if (nextExerciseIndex < exercises.length) {
					// é«˜äº®æ˜¾ç¤ºä¸‹ä¸€ç»„ï¼ˆè¿™é‡Œå¯ä»¥æ·»åŠ ä¸€äº›è§†è§‰æç¤ºï¼‰
					this.activeExerciseIndex = nextExerciseIndex;
					this.activeSetIndex = nextSetIndex;
					
					// éœ‡åŠ¨åé¦ˆ
					uni.vibrateShort();
					
					// ç¡®ä¿å½“å‰åŠ¨ä½œæ²¡æœ‰æŠ˜å 
					if (exercises[nextExerciseIndex].collapsed) {
						exercises[nextExerciseIndex].collapsed = false;
						
						// è§¦å‘å¸ƒå±€æ›´æ–°
						this.$nextTick(() => {
							// å¼ºåˆ¶é‡æ–°è®¡ç®—å¸ƒå±€
							setTimeout(() => {
								this.$forceUpdate();
							}, 50);
						});
					}
					
					// å¦‚æœæ˜¯ä¸‹ä¸€ä¸ªåŠ¨ä½œçš„ç¬¬ä¸€ç»„ï¼Œæ˜¾ç¤ºæç¤º
					if (nextSetIndex === 0 && nextExerciseIndex > 0) {
						uni.showToast({
							title: `å¼€å§‹ ${exercises[nextExerciseIndex].name}`,
							icon: 'none',
							duration: 1500
						});
					}
					
					// å¯ä»¥æ·»åŠ æ»šåŠ¨åˆ°ä¸‹ä¸€ç»„çš„é€»è¾‘
					this.$nextTick(() => {
						setTimeout(() => {
							// å°è¯•æ»šåŠ¨åˆ°å½“å‰å…ƒç´ 
							const dom = uni.requireNativePlugin('dom');
							if (dom && dom.scrollToElement) {
								try {
									// å°è¯•æ»šåŠ¨åˆ°å½“å‰å…ƒç´ 
									const el = this.$refs[`exercise-${nextExerciseIndex}`];
									if (el) {
										dom.scrollToElement(el, { offset: -50 });
									}
								} catch (e) {
									console.log('æ»šåŠ¨åˆ°ä¸‹ä¸€ç»„å¤±è´¥', e);
								}
							}
						}, 300);
					});
				}
			},

  
			// æ¸…é™¤å¼¹çª—
			clearPopups() {
				// TODO: æ¸…é™¤æ‰€æœ‰å¼¹çª—
				this.showWeightDialog = false;
				this.showRepsDialog = false;
				this.showRestDialog = false;
			}
		}
	}
</script>

<style>
	.container {
		flex: 1;
		background-color: #f5f5f5;
		position: relative;
	}
	
	/* åŠ è½½çŠ¶æ€å’Œé”™è¯¯æ ·å¼ */
	.loading-container, .error-container {
		flex: 1;
		justify-content: center;
		align-items: center;
		padding: 60rpx;
	}
	
	.loading-text {
		font-size: 32rpx;
		color: #666666;
	}
	
	.error-container {
		flex-direction: column;
	}
	
	.error-text {
		font-size: 32rpx;
		color: #ff3b30;
		margin-bottom: 40rpx;
		text-align: center;
	}
	
	.error-button {
		background-color: #0A84FF;
		padding: 20rpx 60rpx;
		border-radius: 12rpx;
		align-items: center;
	}
	
	.error-button-text {
		color: white;
		font-size: 32rpx;
	}
	
	/* å¤´éƒ¨æ ·å¼ */
	.header {
		flex-direction: row;
		justify-content: space-between;
		padding: 30rpx;
		background-color: #ffffff;
		border-bottom-width: 1px;
		border-bottom-color: #eeeeee;
	}
	
	.header-left {
		flex-direction: column;
		flex: 1;
	}
	
	.timer-container {
		flex-direction: row;
		align-items: center;
		margin-bottom: 6rpx;
	}
	
	.timer {
		font-size: 56rpx;
		font-weight: bold;
		color: #333333;
	}
	
	.timer-control-button {
		background-color: #0A84FF;
		padding: 10rpx 20rpx;
		border-radius: 12rpx;
		margin-left: 16rpx;
	}
	
	.timer-control-button.pause {
		background-color: #ff3b30;
	}
	
	.timer-button-text {
		color: white;
		font-size: 28rpx;
		font-weight: bold;
	}
	
	.training-name {
		flex-direction: row;
		align-items: center;
	}
	
	.training-title {
		font-size: 38rpx;
		font-weight: bold;
		color: #666666;
	}
	
	.training-name-edit {
		margin-left: 16rpx;
		color: #999999;
		font-size: 32rpx;
	}
	
	.header-right {
		flex-direction: column;
		align-items: flex-end;
		justify-content: center;
		padding-left: 20rpx;
	}
	
	.action-button {
		background-color: #0A84FF;
		padding: 16rpx 32rpx;
		border-radius: 12rpx;
		margin-bottom: 12rpx;
		align-items: center;
	}
	
	.action-button-text {
		color: white;
		font-weight: bold;
		font-size: 32rpx;
	}
	
	.stats {
		flex-direction: column;
		align-items: flex-end;
	}
	
	.stats-text {
		display:flex;
		 
		display: flex;
		flex-direction: row;

		margin-bottom: 4rpx;
		text-align: right;
	}
	
	.stats-highlight {
		font-size: 28rpx;
		color: #666666;
		font-weight: bold;
	}
	
	/* è¿åŠ¨åˆ—è¡¨ */
	.exercise-list {
		flex: 1;
		height: 1000rpx;
		padding: 20rpx;
	}
	
	/* è¿åŠ¨å¡ç‰‡ */
	.exercise-card {
		background-color: #ffffff;
		border-radius: 20rpx;
		margin-bottom: 30rpx;
		overflow: hidden;  
		padding: 20rpx;
		transition-duration: 0.3s;
		transition-timing-function: ease-out;
	}
	
	.exercise-card.collapsed {
		padding-bottom: 12rpx; /* æ”¶èµ·æ—¶å‡å°åº•éƒ¨å†…è¾¹è· */
		margin-bottom: 15rpx; /* æ”¶èµ·æ—¶å‡å°åº•éƒ¨å¤–è¾¹è· */
		/* è®¾å®šå›ºå®šé«˜åº¦é¿å…å®Œå…¨æ¶ˆå¤± */
		/* height: 100rpx; */
	}
	
	/* è¿åŠ¨æ ‡é¢˜ */
	.exercise-header {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 20rpx;
		padding: 0 10rpx;
	}
	
	.exercise-card.collapsed .exercise-header {
		margin-bottom: 0; /* æŠ˜å çŠ¶æ€ä¸‹ç§»é™¤æ ‡é¢˜ä¸‹æ–¹çš„é—´è· */
	}
	
	.exercise-name-wrapper {
		flex: 1;
		 
	}
	
	.exercise-name {
		font-size: 38rpx;
		font-weight: bold;
	}
	
	/* è¿›åº¦æ˜¾ç¤º */
	.exercise-progress {
		flex-direction: row;
		align-items: center;
		margin-top: 5rpx;
		opacity: 1;
		height: 40rpx;
		padding: 0 10rpx;
		width: 100%;
		flex-wrap: wrap;
		display: flex;
	}
	
	/* NVueä¸æ”¯æŒ:noté€‰æ‹©å™¨å’Œdisplay:noneï¼Œå·²é€šè¿‡v-ifå®ç° */
	
	.exercise-sets-count {
		font-size: 26rpx;
		color: #666666;
		margin-right: 16rpx;
	}
	
	.exercise-dots {
		flex-direction: row;
		flex-wrap: wrap;
		margin-top: 3rpx;
		flex: 1;
	}
	
	.dot {
		width: 18rpx;
		height: 18rpx;
		border-radius: 9rpx;
		background-color: #dddddd;
		margin-right: 10rpx;
		margin-bottom: 6rpx;
		transition-property: background-color;
		transition-duration: 0.2s;
	}
	
	.dot.completed {
		background-color: #0A84FF;
	}
	
	.exercise-actions {
		flex-direction: row;
	}
	
	.icon-button {
		padding: 10rpx;
		margin-left: 20rpx;
		width: 60rpx;
		height: 60rpx;
		align-items: center;
		justify-content: center;
	}
	
	.icon {
		font-size: 36rpx;
		color: #666666;
	}
	
	/* å¯æŠ˜å å†…å®¹ */
	.collapsible-content {
		height: 800rpx; /* NVueä¸æ”¯æŒautoï¼Œä½¿ç”¨ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å›ºå®šé«˜åº¦ */
		opacity: 1;
		overflow: hidden;
		transition-duration: 0.25s;
		flex: 1;
	}
	
	.exercise-card.collapsed .collapsible-content {
		height: 0; /* ä½¿ç”¨å›ºå®šé«˜åº¦ */
		opacity: 0;
		padding: 0; /* ç§»é™¤å†…è¾¹è· */
		margin: 0; /* ç§»é™¤å¤–è¾¹è· */
		border-width: 0; /* ç§»é™¤è¾¹æ¡† */
	}
	
	/* ç»„åˆ—è¡¨æ ·å¼ */
	.set-list {
		border-top-width: 1px;
		border-top-color: #eeeeee;
		padding-top: 20rpx;
		margin-top: 10rpx;
	}
	
	.set-list-header {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 16rpx;
		padding: 0 10rpx;
	}
	
	.set-list-title {
		font-weight: bold;
		color: #666666;
		font-size: 30rpx;
	}
	
	.unit-toggle {
		flex-direction: row;
		background-color: #f0f0f0;
		border-radius: 8rpx;
		overflow: hidden;
		height: 50rpx;
	}
	
	.unit-toggle-btn {
		padding: 0;
		width: 80rpx;
		align-items: center;
		justify-content: center;
	}
	
	.unit-toggle-btn.active {
		background-color: #333333;
	}
	
	.unit-text {
		color: #666666;
		font-size: 26rpx;
		font-weight: bold;
		text-align: center;
	}
	
	.active-text {
		color: #ffffff;
	}
	
	/* ç»„è¡Œæ ·å¼ */
	.set-row {
		flex-direction: row;
		padding: 16rpx 0;
		border-bottom-width: 1px;
		border-bottom-color: #f5f5f5;
		align-items: center;
		justify-content: space-between;
	}
	
	.set-header {
		padding-bottom: 10rpx;
	}
	
	.set-header-text {
		color: #999999;
		font-size: 24rpx;
		font-weight: bold;
	}
	
	.set-number-col {
		width: 80rpx;
		color: #666666;
		font-weight: bold;
		text-align: center;
		padding-left: 10rpx;
	}
	
	.set-weight-col, .set-reps-col {
		width: 160rpx;
		padding: 0 20rpx;
	}
	
	.set-input {
		background-color: #ffffff;
		border-width: 1px;
		border-color: #dddddd;
		border-radius: 10rpx;
		padding: 12rpx 8rpx;
		text-align: center;
		height: 76rpx;
		font-size: 34rpx;
		font-weight: bold;
		color: #333333;
	}
	
	.set-complete-col {
		width: 90rpx;
		align-items: center;
		justify-content: center;
		padding: 0 10rpx;
	}
	
	.set-actions-col {
		width: 90rpx;
		align-items: center;
		justify-content: center;
		padding-right: 10rpx;
	}
	
	.set-actions-btn {
		padding: 12rpx;
		width: 80rpx;
		height: 80rpx;
		align-items: center;
		justify-content: center;
		background-color: rgba(0,0,0,0.03);
		border-radius: 8rpx;
	}
	
	/* æ·»åŠ ç»„æŒ‰é’® */
	.add-set {
		padding: 20rpx;
		background-color: #f9f9f9;
		border-width: 1px;
		border-style: dashed;
		border-color: #dddddd;
		border-radius: 12rpx;
		margin-top: 20rpx;
		align-items: center;
	}
	
	.add-set-text {
		color: #666666;
		font-size: 28rpx;
	}
	
	/* å¤‡æ³¨ */
	.exercise-notes {
		margin-top: 20rpx;
		padding: 20rpx;
		background-color: #f9f9f9;
		border-radius: 12rpx;
	}
	
	.notes-text {
		font-size: 28rpx;
		color: #666666;
	}
	
	/* æ·»åŠ åŠ¨ä½œæŒ‰é’® */
	.add-exercise {
		padding: 30rpx;
		background-color: #ffffff;
		border-radius: 20rpx;
		align-items: center;
		margin-bottom: 160rpx; /* ä¸ºåº•éƒ¨å¯¼èˆªç•™å‡ºè¶³å¤Ÿç©ºé—´ */
	}
	
	.add-exercise-text {
		color: #0A84FF;
		font-size: 32rpx;
		font-weight: bold;
	}
	
	/* åº•éƒ¨å¯¼èˆª */
	.bottom-nav {
		position: fixed;
		bottom: 0;
		left: 0;
		right: 0;
		flex-direction: row;
		background-color: #ffffff;
		box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);
		z-index: 100;
		height: 130rpx;
		padding-bottom: 34rpx; /* æ›¿æ¢env(safe-area-inset-bottom)ä¸ºå›ºå®šå€¼ */
	}
	
	.bottom-nav-btn {
		flex: 1;
		padding: 20rpx 0;
		align-items: center;
		justify-content: center;
	}
	
	.bottom-icon {
		font-size: 44rpx;
		margin-bottom: 6rpx;
	}
	
	.bottom-text {
		font-size: 24rpx;
		color: #666666;
	}
	
	.bottom-nav-btn.save {
		background-color: #0A84FF;
	}
	
	.bottom-nav-btn.save .bottom-icon {
		color: #ffffff;
	}
	
	.bottom-nav-btn.save .bottom-text {
		color: #ffffff;
	}
	
	.bottom-nav-btn.delete .bottom-text {
		color: #FF3B30;
	}
	
	.bottom-nav-btn.delete .bottom-icon {
		color: #FF3B30;
	}
	
	/* è‡ªå®šä¹‰å¤é€‰æ¡† */
	.custom-checkbox {
		width: 50rpx;
		height: 50rpx;
		border-radius: 8rpx;
		border-width: 2rpx;
		border-color: #dddddd;
		align-items: center;
		justify-content: center;
		background-color: #ffffff;
	}
	
	.checkbox-inner {
		width: 50rpx;
		height: 50rpx;
		border-radius: 6rpx;
		background-color: #0A84FF;
		align-items: center;
		justify-content: center;
	}
	
	.checkbox-icon {
		color: #ffffff;
		font-size: 32rpx;
		font-weight: bold;
	}
	
	/* æ“ä½œæŒ‰é’®æ ·å¼ */
	.icon {
		font-size: 40rpx;
		color: #666666;
	}
	
	.set-actions-btn {
		padding: 12rpx;
		width: 80rpx;
		height: 80rpx;
		align-items: center;
		justify-content: center;
		background-color: rgba(0,0,0,0.03);
		border-radius: 8rpx;
	}

	/* ä¼‘æ¯è®¡æ—¶å™¨åŒ…è£…å™¨ */
	.rest-timer-wrapper {
		width: 700rpx;
		margin: 10rpx 25rpx;
		height: 0;
		opacity: 0;
		overflow: hidden;
		transition-property: height, opacity;
		transition-duration: 0.3s;
	}

	.rest-timer-wrapper.visible {
		height: 80rpx;
		opacity: 1;
		margin-bottom: 20rpx;
	}
	
	/* æ— æ•°æ®æ—¶ */
	.no-data {
		align-items: center;
		padding: 100rpx 0;
	}
	
	.no-data-text {
		font-size: 32rpx;
		color: #999999;
	}
	

</style> 