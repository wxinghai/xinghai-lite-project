<template>
	<view class="container" :style="containerStyle">
		<!-- è®­ç»ƒä¼šè¯å†…å®¹ -->
 
			<!-- é¡µé¢å¤´éƒ¨ -->
			<view class="header">
				<view class="header-left">
					<view class="timer-container">
						<text class="timer">{{ formattedSessionTime }}</text>
						<!-- è®¡æ—¶å™¨æ§åˆ¶æŒ‰é’® -->
						<view v-if="!timer.isRunning" class="timer-control-button start">
							<text class="timer-button-text">å¼€å§‹è®¡æ—¶</text>
						</view>
						<view v-else class="timer-control-button pause">
							<text class="timer-button-text">æš‚åœ</text>
						</view>
					</view>
					<view class="training-name">
						<text class="training-title">{{ trainingData.title }}</text>
						<text class="training-name-edit">âœï¸</text>
					</view>
				</view>

				<view class="header-right">
					<view class="action-button">
						<text class="action-button-text">å®Œæˆ</text>
					</view>
					<view class="stats">
						<view class="stats-text"><text class="stats-highlight">{{ completedSets }}/{{ totalSets }}
								ç»„</text></view>
						<view class="stats-text"><text class="stats-highlight">{{ totalVolume }}kg å®¹é‡</text></view>
					</view>
				</view>
			</view>
			<!-- è¿åŠ¨åˆ—è¡¨ -->
			<list class="exercise-list" showScrollbar="true">
				<cell v-for="(exercise, exerciseIndex) in trainingData.exercises" :key="exercise.id">
					<view class="exercise-card" :class="{ 'collapsed': exercise.collapsed }"
						:ref="`exercise-${exerciseIndex}`">
						<!-- è¿åŠ¨æ ‡é¢˜æ  -->
						<view class="exercise-header">
							<view class="exercise-name-wrapper">
								<text class="exercise-name">{{ exercise.name }}</text>
								<!-- æŠ˜å çŠ¶æ€ä¸‹æ˜¾ç¤ºè¿›åº¦ -->
								<view class="exercise-progress" v-if="exercise.collapsed">
									<text class="exercise-sets-count">{{ exercise.sets.length }}ç»„</text>
									<view class="exercise-dots">
										<view v-for="(set, dotIndex) in exercise.sets" :key="'dot-'+dotIndex"
											class="dot" :class="{ 'completed': set.completed }"></view>
									</view>
								</view>
							</view>

							<view class="exercise-actions">
								<view class="icon-button">
									<text class="icon">ğŸ“</text>
								</view>
								<view class="icon-button">
									<text class="icon">â‹¯</text>
								</view>
							</view>
						</view>



						<!-- è¿åŠ¨è¯¦æƒ…å†…å®¹ -->
						<view class="collapsible-content">
							<!-- ç»„æ•°åˆ—è¡¨ -->
							<view class="set-list">
								<view class="set-list-header">
									<text class="set-list-title">ç»„æ•°ä¿¡æ¯</text>
									<view class="unit-toggle">
										<view class="unit-toggle-btn"
											:class="{ 'active': exercise.weightUnit === 'kg' }">
											<text class="unit-text"
												:class="{ 'active-text': exercise.weightUnit === 'kg' }">KG</text>
										</view>
										<view class="unit-toggle-btn"
											:class="{ 'active': exercise.weightUnit === 'lbs' }">
											<text class="unit-text"
												:class="{ 'active-text': exercise.weightUnit === 'lbs' }">LBS</text>
										</view>
									</view>
								</view>

								<!-- ç»„æ•°è¡¨å¤´ -->
								<view class="set-row set-header">
									<text class="set-header-text set-number-col">ç»„æ•°</text>
									<text class="set-header-text set-weight-col">
										é‡é‡({{ exercise.weightUnit }})
									</text>
									<text class="set-header-text set-reps-col">æ¬¡æ•°</text>
									<text class="set-header-text set-complete-col">å®Œæˆ</text>
									<text class="set-header-text set-actions-col"></text>
								</view>

								<!-- ç»„æ•°åˆ—è¡¨ -->
								<view class="set-row" v-for="(set, setIndex) in exercise.sets"
									:key="'set-'+exerciseIndex+'-'+setIndex">
									<text class="set-number-col">{{ setIndex + 1 }}</text>
									<view class="set-weight-col">
										<input class="set-input" type="number" v-model="set.weight" />
									</view>
									<view class="set-reps-col">
										<input class="set-input" type="number" v-model="set.reps" />
									</view>
									<view class="set-complete-col">
										<view class="custom-checkbox">
											<view class="checkbox-inner" v-if="set.completed">
												<text class="checkbox-icon">âœ“</text>
											</view>
										</view>
									</view>
									<view class="set-actions-col">
										<view class="set-actions-btn">
											<text class="icon">â‹¯</text>
										</view>
									</view>
								</view>

								<!-- æ·»åŠ ç»„æ•°æŒ‰é’® -->
								<view class="add-set">
									<text class="add-set-text">+ æ·»åŠ ç»„æ•°</text>
								</view>
							</view>

							<!-- å¤‡æ³¨ä¿¡æ¯ -->
							<view class="exercise-notes" v-if="exercise.notes">
								<text class="notes-text">{{ exercise.notes }}</text>
							</view>
						</view>
					</view>
				</cell>

				<!-- æ·»åŠ åŠ¨ä½œæŒ‰é’® -->
				<cell>
					<view class="add-exercise">
						<text class="add-exercise-text">+ æ·»åŠ åŠ¨ä½œ</text>
					</view>
				</cell>
			</list>

			<!-- åº•éƒ¨å¯¼èˆª -->
			<view class="bottom-nav">
				<view class="bottom-nav-btn">
					<text class="bottom-icon">â¬‡ï¸</text>
					<text class="bottom-text">æœ€å°åŒ–</text>
				</view>
				<view class="bottom-nav-btn">
					<text class="bottom-icon">â±ï¸</text>
					<text class="bottom-text">ä¼‘æ¯è®¡æ—¶</text>
				</view>
				<view class="bottom-nav-btn">
					<text class="bottom-icon">â•</text>
					<text class="bottom-text">æ·»åŠ åŠ¨ä½œ</text>
				</view>
				<view class="bottom-nav-btn delete">
					<text class="bottom-icon">ğŸ—‘ï¸</text>
					<text class="bottom-text">åˆ é™¤è®­ç»ƒ</text>
				</view>
				<view class="bottom-nav-btn save">
					<text class="bottom-icon">ğŸ’¾</text>
					<text class="bottom-text">ä¿å­˜è¿”å›</text>
				</view>
			</view>
	 
	</view>
</template>

<script>
	export default {

		data() {
			return {
				// è®­ç»ƒä¼šè¯æ•°æ®
				trainingData: {
					title:'æµ‹è¯•',
					exercises:[]
				},
				// æ€»é‡é‡
				totalVolume: 0,
				// é¡µé¢çŠ¶æ€
				loading: true,
				error: null,

			}
		},

		computed: {
			containerStyle() {
				return {
					paddingTop: getApp().globalData.statusBarHeight
				}
			},
			// è®¡ç®—å·²å®Œæˆç»„æ•°
			completedSets() {
				return 5;
			},

			// è®¡ç®—æ€»ç»„æ•°
			totalSets() {
				return 10;
			},

			// æ ¼å¼åŒ–ä¼šè¯æ—¶é—´
			formattedSessionTime() {

				return `00:00`;
			}
		},
		onReady() {
			uni.getSubNVueById("training").hide()
		},

		methods: {
			clickBtn() {
				console.log("å…³é—­");
				uni.getSubNVueById("training").hide()
			}
		}
	}
</script>

<style>
	.container {
		flex: 1;
		background-color: #f5f5f5;
		position: relative;
	}

	/* åŠ è½½çŠ¶æ€å’Œé”™è¯¯æ ·å¼ */
	.loading-container,
	.error-container {
		flex: 1;
		justify-content: center;
		align-items: center;
		padding: 60rpx;
	}

	.loading-text {
		font-size: 32rpx;
		color: #666666;
	}

	.error-container {
		flex-direction: column;
	}

	.error-text {
		font-size: 32rpx;
		color: #ff3b30;
		margin-bottom: 40rpx;
		text-align: center;
	}

	.error-button {
		background-color: #0A84FF;
		padding: 20rpx 60rpx;
		border-radius: 12rpx;
		align-items: center;
	}

	.error-button-text {
		color: white;
		font-size: 32rpx;
	}

	/* å¤´éƒ¨æ ·å¼ */
	.header {
		flex-direction: row;
		justify-content: space-between;
		padding: 30rpx;
		background-color: #ffffff;
		border-bottom-width: 1px;
		border-bottom-color: #eeeeee;
	}

	.header-left {
		flex-direction: column;
		flex: 1;
	}

	.timer-container {
		flex-direction: row;
		align-items: center;
		margin-bottom: 6rpx;
	}

	.timer {
		font-size: 56rpx;
		font-weight: bold;
		color: #333333;
	}

	.timer-control-button {
		background-color: #0A84FF;
		padding: 10rpx 20rpx;
		border-radius: 12rpx;
		margin-left: 16rpx;
	}

	.timer-control-button.pause {
		background-color: #ff3b30;
	}

	.timer-button-text {
		color: white;
		font-size: 28rpx;
		font-weight: bold;
	}

	.training-name {
		flex-direction: row;
		align-items: center;
	}

	.training-title {
		font-size: 38rpx;
		font-weight: bold;
		color: #666666;
	}

	.training-name-edit {
		margin-left: 16rpx;
		color: #999999;
		font-size: 32rpx;
	}

	.header-right {
		flex-direction: column;
		align-items: flex-end;
		justify-content: center;
		padding-left: 20rpx;
	}

	.action-button {
		background-color: #0A84FF;
		padding: 16rpx 32rpx;
		border-radius: 12rpx;
		margin-bottom: 12rpx;
		align-items: center;
	}

	.action-button-text {
		color: white;
		font-weight: bold;
		font-size: 32rpx;
	}

	.stats {
		flex-direction: column;
		align-items: flex-end;
	}

	.stats-text {
		display: flex;

		display: flex;
		flex-direction: row;

		margin-bottom: 4rpx;
		text-align: right;
	}

	.stats-highlight {
		font-size: 28rpx;
		color: #666666;
		font-weight: bold;
	}

	/* è¿åŠ¨åˆ—è¡¨ */
	.exercise-list {
		flex: 1;
		height: 1300rpx;
		padding: 20rpx;
		padding-bottom: 200rpx;
	}

	/* è¿åŠ¨å¡ç‰‡ */
	.exercise-card {
		background-color: #ffffff;
		border-radius: 20rpx;
		margin-bottom: 30rpx;
		overflow: hidden;
		padding: 20rpx;
		transition-duration: 0.3s;
		transition-timing-function: ease-out;
	}

	.exercise-card.collapsed {
		padding-bottom: 12rpx;
		/* æ”¶èµ·æ—¶å‡å°åº•éƒ¨å†…è¾¹è· */
		margin-bottom: 15rpx;
		/* æ”¶èµ·æ—¶å‡å°åº•éƒ¨å¤–è¾¹è· */
		/* è®¾å®šå›ºå®šé«˜åº¦é¿å…å®Œå…¨æ¶ˆå¤± */
		/* height: 100rpx; */
	}

	/* è¿åŠ¨æ ‡é¢˜ */
	.exercise-header {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 20rpx;
		padding: 0 10rpx;
	}

	.exercise-card.collapsed .exercise-header {
		margin-bottom: 0;
		/* æŠ˜å çŠ¶æ€ä¸‹ç§»é™¤æ ‡é¢˜ä¸‹æ–¹çš„é—´è· */
	}

	.exercise-name-wrapper {
		flex: 1;

	}

	.exercise-name {
		font-size: 38rpx;
		font-weight: bold;
	}

	/* è¿›åº¦æ˜¾ç¤º */
	.exercise-progress {
		flex-direction: row;
		align-items: center;
		margin-top: 5rpx;
		opacity: 1;
		height: 40rpx;
		padding: 0 10rpx;
		width: 100%;
		flex-wrap: wrap;
		display: flex;
	}

	/* NVueä¸æ”¯æŒ:noté€‰æ‹©å™¨å’Œdisplay:noneï¼Œå·²é€šè¿‡v-ifå®ç° */

	.exercise-sets-count {
		font-size: 26rpx;
		color: #666666;
		margin-right: 16rpx;
	}

	.exercise-dots {
		flex-direction: row;
		flex-wrap: wrap;
		margin-top: 3rpx;
		flex: 1;
	}

	.dot {
		width: 18rpx;
		height: 18rpx;
		border-radius: 9rpx;
		background-color: #dddddd;
		margin-right: 10rpx;
		margin-bottom: 6rpx;
		transition-property: background-color;
		transition-duration: 0.2s;
	}

	.dot.completed {
		background-color: #0A84FF;
	}

	.exercise-actions {
		flex-direction: row;
	}

	.icon-button {
		padding: 10rpx;
		margin-left: 20rpx;
		width: 60rpx;
		height: 60rpx;
		align-items: center;
		justify-content: center;
	}

	.icon {
		font-size: 36rpx;
		color: #666666;
	}

	/* å¯æŠ˜å å†…å®¹ */
	.collapsible-content {
		height: 800rpx;
		/* NVueä¸æ”¯æŒautoï¼Œä½¿ç”¨ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å›ºå®šé«˜åº¦ */
		opacity: 1;
		overflow: hidden;
		transition-duration: 0.25s;
		flex: 1;
	}

	.exercise-card.collapsed .collapsible-content {
		height: 0;
		/* ä½¿ç”¨å›ºå®šé«˜åº¦ */
		opacity: 0;
		padding: 0;
		/* ç§»é™¤å†…è¾¹è· */
		margin: 0;
		/* ç§»é™¤å¤–è¾¹è· */
		border-width: 0;
		/* ç§»é™¤è¾¹æ¡† */
	}

	/* ç»„åˆ—è¡¨æ ·å¼ */
	.set-list {
		border-top-width: 1px;
		border-top-color: #eeeeee;
		padding-top: 20rpx;
		margin-top: 10rpx;
	}

	.set-list-header {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 16rpx;
		padding: 0 10rpx;
	}

	.set-list-title {
		font-weight: bold;
		color: #666666;
		font-size: 30rpx;
	}

	.unit-toggle {
		flex-direction: row;
		background-color: #f0f0f0;
		border-radius: 8rpx;
		overflow: hidden;
		height: 50rpx;
	}

	.unit-toggle-btn {
		padding: 0;
		width: 80rpx;
		align-items: center;
		justify-content: center;
	}

	.unit-toggle-btn.active {
		background-color: #333333;
	}

	.unit-text {
		color: #666666;
		font-size: 26rpx;
		font-weight: bold;
		text-align: center;
	}

	.active-text {
		color: #ffffff;
	}

	/* ç»„è¡Œæ ·å¼ */
	.set-row {
		flex-direction: row;
		padding: 16rpx 0;
		border-bottom-width: 1px;
		border-bottom-color: #f5f5f5;
		align-items: center;
		justify-content: space-between;
	}

	.set-header {
		padding-bottom: 10rpx;
	}

	.set-header-text {
		color: #999999;
		font-size: 24rpx;
		font-weight: bold;
	}

	.set-number-col {
		width: 80rpx;
		color: #666666;
		font-weight: bold;
		text-align: center;
		padding-left: 10rpx;
	}

	.set-weight-col,
	.set-reps-col {
		width: 160rpx;
		padding: 0 20rpx;
	}

	.set-input {
		background-color: #ffffff;
		border-width: 1px;
		border-color: #dddddd;
		border-radius: 10rpx;
		padding: 12rpx 8rpx;
		text-align: center;
		height: 76rpx;
		font-size: 34rpx;
		font-weight: bold;
		color: #333333;
	}

	.set-complete-col {
		width: 90rpx;
		align-items: center;
		justify-content: center;
		padding: 0 10rpx;
	}

	.set-actions-col {
		width: 90rpx;
		align-items: center;
		justify-content: center;
		padding-right: 10rpx;
	}

	.set-actions-btn {
		padding: 12rpx;
		width: 80rpx;
		height: 80rpx;
		align-items: center;
		justify-content: center;
		background-color: rgba(0, 0, 0, 0.03);
		border-radius: 8rpx;
	}

	/* æ·»åŠ ç»„æŒ‰é’® */
	.add-set {
		padding: 20rpx;
		background-color: #f9f9f9;
		border-width: 1px;
		border-style: dashed;
		border-color: #dddddd;
		border-radius: 12rpx;
		margin-top: 20rpx;
		align-items: center;
	}

	.add-set-text {
		color: #666666;
		font-size: 28rpx;
	}

	/* å¤‡æ³¨ */
	.exercise-notes {
		margin-top: 20rpx;
		padding: 20rpx;
		background-color: #f9f9f9;
		border-radius: 12rpx;
	}

	.notes-text {
		font-size: 28rpx;
		color: #666666;
	}

	/* æ·»åŠ åŠ¨ä½œæŒ‰é’® */
	.add-exercise {
		padding: 30rpx;
		background-color: #ffffff;
		border-radius: 20rpx;
		align-items: center;
		margin-bottom: 160rpx;
		/* ä¸ºåº•éƒ¨å¯¼èˆªç•™å‡ºè¶³å¤Ÿç©ºé—´ */
	}

	.add-exercise-text {
		color: #0A84FF;
		font-size: 32rpx;
		font-weight: bold;
	}

	/* åº•éƒ¨å¯¼èˆª */
	.bottom-nav {
		position: fixed;
		bottom: 0;
		left: 0;
		right: 0;
		flex-direction: row;
		background-color: #ffffff;
		box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);
		z-index: 100;
		height: 130rpx;
		padding-bottom: 34rpx;
		/* æ›¿æ¢env(safe-area-inset-bottom)ä¸ºå›ºå®šå€¼ */
	}

	.bottom-nav-btn {
		flex: 1;
		padding: 20rpx 0;
		align-items: center;
		justify-content: center;
	}

	.bottom-icon {
		font-size: 44rpx;
		margin-bottom: 6rpx;
	}

	.bottom-text {
		font-size: 24rpx;
		color: #666666;
	}

	.bottom-nav-btn.save {
		background-color: #0A84FF;
	}

	.bottom-nav-btn.save .bottom-icon {
		color: #ffffff;
	}

	.bottom-nav-btn.save .bottom-text {
		color: #ffffff;
	}

	.bottom-nav-btn.delete .bottom-text {
		color: #FF3B30;
	}

	.bottom-nav-btn.delete .bottom-icon {
		color: #FF3B30;
	}

	/* è‡ªå®šä¹‰å¤é€‰æ¡† */
	.custom-checkbox {
		width: 50rpx;
		height: 50rpx;
		border-radius: 8rpx;
		border-width: 2rpx;
		border-color: #dddddd;
		align-items: center;
		justify-content: center;
		background-color: #ffffff;
	}

	.checkbox-inner {
		width: 50rpx;
		height: 50rpx;
		border-radius: 6rpx;
		background-color: #0A84FF;
		align-items: center;
		justify-content: center;
	}

	.checkbox-icon {
		color: #ffffff;
		font-size: 32rpx;
		font-weight: bold;
	}

	/* æ“ä½œæŒ‰é’®æ ·å¼ */
	.icon {
		font-size: 40rpx;
		color: #666666;
	}

	.set-actions-btn {
		padding: 12rpx;
		width: 80rpx;
		height: 80rpx;
		align-items: center;
		justify-content: center;
		background-color: rgba(0, 0, 0, 0.03);
		border-radius: 8rpx;
	}

	/* ä¼‘æ¯è®¡æ—¶å™¨åŒ…è£…å™¨ */
	.rest-timer-modal {
		position: absolute;
		width: 750rpx;
		top: 0;
		z-index: 1000;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		background-color: rgba(0, 0, 0, 0.8);
		bottom: 0;

	}

	.zui-xiao {
		position: absolute;
		width: 150rpx;
		height: 150rpx;
		z-index: 1000;
		right: 0;
		border-radius: 75rpx;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		background-color: rgba(0, 0, 0, 0.8);
		bottom: 150rpx;
	}

	.rest-dialog {
		width: 600rpx;
		background-color: #ffffff;
		border-radius: 20rpx;
		overflow: hidden;
		box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.2);
		flex-direction: column;
		align-items: center;
		padding: 40rpx 0;
	}

	.modal-header {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		width: 600rpx;
		padding: 0 30rpx;
		margin-bottom: 30rpx;
	}

	.modal-title {
		font-size: 40rpx;
		font-weight: bold;
		color: #333333;
	}

	.minimize-btn {
		padding: 10rpx 20rpx;
		background-color: #f0f0f0;
		border-radius: 10rpx;
		align-items: center;
	}

	.minimize-btn-text {
		font-size: 28rpx;
		color: #666666;
	}

	/* è¿›åº¦ç¯ç›¸å…³æ ·å¼ */
	.timer-circle {
		width: 300rpx;
		height: 300rpx;
		position: relative;
		margin-bottom: 30rpx;
		border-radius: 150rpx;
		overflow: hidden;
	}

	.progress-ring {
		position: absolute;
		top: 0;
		left: 0;
		width: 300rpx;
		height: 300rpx;
		border-radius: 150rpx;
	}

	.progress-background {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		border-radius: 150rpx;
		background-color: rgba(240, 240, 240, 0.3);
	}

	.progress-indicator {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		border-radius: 150rpx;
		/* èƒŒæ™¯è‰²å°†åœ¨JSä¸­åŠ¨æ€è®¾ç½®ä¸ºæ¸å˜ */
	}

	.timer-display {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		background-color: #ffffff;
		border-radius: 150rpx;
		transform: scale(0.9);
		z-index: 10;
	}

	.time {
		font-size: 80rpx;
		font-weight: bold;
		color: #333333;
	}

	.total-time {
		font-size: 28rpx;
		color: #999999;
		margin-top: 10rpx;
	}

	.controls {
		flex-direction: row;
		justify-content: space-around;
		width: 600rpx;
		padding: 0 30rpx;
		margin-top: 30rpx;
	}

	.control-btn {
		padding: 15rpx 30rpx;
		background-color: #f0f0f0;
		border-radius: 15rpx;
		align-items: center;
		justify-content: center;
	}

	.control-btn.minus-btn {
		background-color: #ff3b30;
	}

	.control-btn.plus-btn {
		background-color: #0A84FF;
	}

	.control-btn.finish-btn {
		background-color: #0A84FF;
	}

	.btn-text {
		color: #ffffff;
		font-size: 32rpx;
		font-weight: bold;
	}

	.rest-mini {

		height: 150rpx;
		width: 150rpx;
		border-radius: 75rpx;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		background-color: transparent;

	}


	.rest-mini-time {
		font-size: 40rpx;
		font-weight: bold;
		color: #ffffff;
		background-color: transparent;
	}


	/* æ— æ•°æ®æ—¶ */
	.no-data {
		align-items: center;
		padding: 100rpx 0;
	}

	.no-data-text {
		font-size: 32rpx;
		color: #999999;
	}
</style>